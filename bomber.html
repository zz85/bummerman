
<!doctype html>
<html lang="en">
	<head>
		<title>joosh bomberman WIP</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>
			body {
				font-family: Monospace;
				background-color: #f0f0f0;
				margin: 0px;
				overflow: hidden;
			}
		</style>
	</head>
	<body>
		<script>
		
			// Dimension
			var cellWidth = 100;
			var cellHeight = 100;
			
			var TYPES = {
				NONE: 0,
				WALL: 1
			};
			
			var WorldMap = function( columns, rows ) {

				this.columns = columns;				
				this.rows = rows;

				var cells = [];
				
				var i = 0, il = columns, j, jl = rows;
				
				for (;i<il; i++) {
					
					cells[i] = [];
					for (j=0;j<jl;j++) {
						cells[i][j] = TYPES.NONE;
					}
					
				}
				
				this.cells = cells;
				this.width = cellWidth * columns;
				this.height = cellHeight * rows;
			};
			
			WorldMap.prototype.createWalls = function() {
				var i=0, il= this.columns, j, jl = this.rows;
				var cells = this.cells;
				
				for (i=1;i<il; i+=2) {
					for (j=1;j<jl;j+=2) {
						cells[i][j] = TYPES.WALL;
					}
				}
				
			};
			
			WorldMap.prototype.eachTile = function( emit ) {
				var i=0, il= this.columns, j, jl = this.rows;
				var cells = this.cells;
				
				for (i=0;i<il; i++) {
					for (j=0;j<jl;j++) {
						emit(i,j, cells[i][j]);
					}
				}
				
			};
			
			
			var Player = function() {
				
				var geometry = new THREE.SphereGeometry( 40, 12, 12 );
				var material = new THREE.MeshLambertMaterial( { color: 0x0080f0, opacity: 1, shading: THREE.SmoothShading } );
				var mesh = new THREE.Mesh( geometry,  [ material ] );
				mesh.position.y = 50;
				this.mesh = mesh;
				this.positionAt(0,0)
				
			};
			
			Player.prototype.positionAt = function(column, row ) {
				positionAt(this.mesh.position, column, row);
			};
			
			Player.prototype.moveBy = function( x, z ) {
				this.mesh.position.x += x;
				this.mesh.position.z += z;
			};
			
			function positionAt(vector, column, row) {
				vector.x = column * cellWidth - map.width/2 + cellWidth/2;
				vector.z = row * cellHeight - map.height/2 + cellHeight/2;
			}
			
			
			
			var map = new WorldMap(11, 11);
			map.createWalls();
			console.log(map);
		
			document.addEventListener( 'keydown', onDocumentKeyDown, false );
			document.addEventListener( 'keyup', onDocumentKeyUp, false );

			function onDocumentKeyDown( event ) {
				console.log(event.keyCode);
				switch( event.keyCode ) {
					case 87:
						// up
						player1.moveBy(-20, 0); break;
					case 83:
						// down
						player1.moveBy(20, 0); break;
					case 65:
						// left
						player1.moveBy(0, 20); break;
					case 68:
						// right
						player1.moveBy(0, -20); break;
					
					case 16: isShiftDown = true; break;
					case 17: isCtrlDown = true; break;

				}

			}

			function onDocumentKeyUp( event ) {

				switch( event.keyCode ) {

					case 16: isShiftDown = false; break;
					case 17: isCtrlDown = false; break;

				}
			}

		

			

		</script>

	</body>
</html>
